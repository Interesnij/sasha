{% load liked_user %}

<span data-pk="{{ comment.pk }}">
  <a href="{% url 'user' pk=comment.commenter.pk %}" class="hover-target">
  {% if comment.commenter.avatar %}
    <img src="{{ comment.commenter.avatar.url }}" alt="user_avatar" />
  {% else %}
    <img src="/static/images/user.png" alt="user" />
  {% endif %}
  </a>
  <h6>
    <span class="comment-author">
      <a href="{% url 'user' pk=comment.commenter.pk %}" class="hover-target commenter" style="color:white">
        {{ comment.commenter }}
      </a>
    </span>
    <small>{{ comment.get_created }}</small>
  </h6>
  <p class="mt-2">{{ comment.text }}</p>
  <span class="like2 {% if comment.likes.all|user_in:user %}text-success{% endif %}"
        {% if request.user.is_authenticated %}
        data-tooltip="Мне нравится"
        {% else %}
        data-tooltip="Войдите или зарегистрируйтесь"
        {% endif %}>
      <span class="fa fa-thumbs-o-up"></span>
      <span data-count="like">{{ comment.likes_count }}</span>
  </span>
  &nbsp;&nbsp;
  <span class="dislike2 {% if comment.dislikes.all|user_in:user %}text-danger{% endif %}"
        {% if request.user.is_authenticated %}
        data-tooltip="Мне не нравится"
        {% else %}
        data-tooltip="Войдите или зарегистрируйтесь"
        {% endif %}>
      <span class="fa fa-thumbs-o-down"></span>
      <span data-count="dislike">{{ comment.dislikes_count }}</span>
  </span>
  &nbsp;&nbsp;
  {% if request.user.is_authenticated %}
  <span style="cursor:pointer" class="ml-0 mr-1 mt-3 mb-1 hover-target reply_form_open">ответить</span>
  {% endif %}

  <div style="display:none">
      <form>
          {% csrf_token %}
          <input type="hidden" name="post_comment" value="{{ comment.pk }}">
          <div class="row no-gutters" style="margin-top: 20px;">
              <div class="col">
                  <div class="input-group input-group-sm">
                      <textarea name="text" class="form-control text-comment form-control-rounded"></textarea>
                      <button class="btn-long mt-4 hover-target reply_comment" type="button">Комментировать</button>
                  </div>
              </div>
          </div>
      </form>
  </div>

  <span style="cursor:pointer;display: flex;" class="show_replies content-color-primary">
      {% if comment.count_replies %}
      ---- {{ comment.count_replies_ru }} ----
      {% endif %}
  </span>

  <span class="stream_reply_comments">
      {% for reply in comment.get_replies %}
        {% include 'reply.html' %}
      {% endfor %}
  </span>
</span>
{% if not forloop.last %}
<div class="separator-wrap pt-4 pb-4">
  <span class="separator"><span class="separator-line dashed"></span></span>
</div>
{% endif %}
